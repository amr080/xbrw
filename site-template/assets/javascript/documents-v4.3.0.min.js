function collect_document_elements(){$.each($("[data-location][data-type]").not("[data-collected=true]"),function(t,e){$(e).data("id")||$(e).attr("data-id",$(e).data("location")+"-"+$(e).data("type")+"-"+t),initialize_call_tracker(e),$(e).attr("data-collected",!0)})}function initialize_call_tracker(t){var e=new CallTracker(t);test_for_clone(e),$.each(e.locationArray,function(t,a){make_api_calls(e,a)})}function CallTracker(t){this.htmlElement=t,this.htmlData=$(t).data(),this.locationArray=replace_domain_location(this.htmlData.location),this.typeArray=String(this.htmlData.type).split(","),this.triggerSelector=scope_trigger_selector(this.htmlElement),this.expected=this.locationArray.length*this.typeArray.length,this.returned=0,this.api_data=[],this.sortedData=[],this.cloneDetected=!1,this.clone_i=0,this.append_i=0}function make_api_calls(t,e){$.each(t.typeArray,function(a,r){var n=e.toLowerCase(),o=api_url_v2+"Document/"+n+"/"+r;api.getData(o,e+"-"+r,function(e){verifyData(e)?(t.returned++,t.returned<=t.expected&&t.api_data.push(e),test_expected_vs_returned(t)):hide_and_replace_element(t)})})}function test_expected_vs_returned(t){t.returned==t.expected&&(t.sortedData=[].concat.apply([],t.api_data),filter_tags(t),t.htmlData.sortorder&&(t.sortedData=sortDataArray_v2(t.htmlData.sortorder,t.sortedData)),verifyData(t.sortedData)?t.cloneDetected?clone_element(t):single_element(t):hide_and_replace_element(t))}function replace_domain_location(t){var e=String(t).split(","),a=e.map(function(t){return"domain"==t.toLowerCase()?api_domain:t});return a}function scope_trigger_selector(t){var e=$(t).data(),a="";for(var r in e)a+="clone"==r?"[data-"+r+"]":"[data-"+r+"='"+e[r]+"']";return a}function hide_and_replace_element(t){t.expected>1?(t.expected--,test_expected_vs_returned(t)):t.htmlData.empty?$(t.triggerSelector).is("a")?$(t.triggerSelector).parent().text(t.htmlData.empty):$(t.triggerSelector).text(t.htmlData.empty):t.htmlData.tag&&0==$(t.triggerSelector).has('[data-clone="true"]').length?$(t.triggerSelector).hide():$(t.htmlElement).hide(),documentCallback(t)}function test_for_clone(t){$(t.htmlElement).is('[data-clone="true"]')?(t.cloneDetected=!0,t.cloneSelector=$(t.triggerSelector+'[data-clone="true"]'),t.cloneSelector.attr("data-position",0),t.cloneTargetSelector=function(){return t.triggerSelector+'[data-position="'+t.clone_i+'"]'},t.cloneTarget="insertAfter"):$(t.htmlElement).has('[data-clone="true"]').length>0&&(t.cloneDetected=!0,t.cloneSelector=$(t.triggerSelector).find('[data-clone="true"]'),t.cloneSelector.attr("data-position",0),t.cloneTargetSelector=function(){return $(t.cloneSelector.parent())},t.cloneTarget="appendTo")}function filter_tags(t){var e=t.htmlData,a=String(e.excludetags).split(","),r=String(e.tag).split(",");(e.excludetags||e.tag)&&(t.sortedData=t.sortedData.filter(function(t){for(var e=String(t.tag).split(","),n=0;n<e.length;n++){if(-1!=r.indexOf(e[n])&&-1==a.indexOf(e[n]))return t;if("undefined"==r&&-1==a.indexOf(e[n]))return t;if(-1!=a.indexOf(e[n]))break}}))}function clone_element(t){var e;t.looplength=handle_loop_length(t);for(var a=1;a<t.looplength;a++)e=t.cloneSelector.clone().attr("data-position",a).attr("data-clone","false"),e[t.cloneTarget](t.cloneTargetSelector()),t.clone_i++;for(a=0;a<t.looplength;a++)t.append_i=a,t.thisSelector=$(t.triggerSelector+'[data-position="'+a+'"]').add(t.triggerSelector+' [data-position="'+a+'"]'),t.keySelector=$(t.triggerSelector+'[data-position="'+a+'"][data-key]').add(t.triggerSelector+' [data-position="'+a+'"][data-key]').add(t.triggerSelector+' [data-position="'+a+'"] [data-key]').add(t.triggerSelector+'[data-position="'+a+'"] [data-key]'),append_data(t);documentCallback(t)}function single_element(t){t.thisSelector=$(t.triggerSelector),t.keySelector=$(t.triggerSelector+"[data-key]").add(t.triggerSelector+" [data-key]"),t.append_i=0,append_data(t),documentCallback(t)}function documentCallback(t){"undefined"!=typeof docDataComplete&&$.isFunction(docDataComplete)&&docDataComplete(t.htmlData,t.sortedData)}function handle_loop_length(t){var e=t.htmlData.looplength;return!e&&1==t.cloneDetected||e>t.sortedData.length?e=t.sortedData.length:e||t.cloneDetected||(e=1),e}function append_data(t){var e=t.keySelector,a=t.sortedData,r=t.thisSelector,n=t.append_i;r.attr("data-startdate",dateFormatter_v2(a[n].startdate,t.htmlData.dateformat)).attr("data-rangestartdate",dateFormatter_v2(a[n].rangestartdate,t.htmlData.dateformat)).attr("data-title",a[n].title).attr("data-url",a[n].url).attr("data-symbol",a[n].symbol).attr("data-abbrev",a[n].abbreviation).attr("data-tag",a[n].tag).find("a,button").attr("data-title",a[n].title),$.each(e,function(e,r){var o=$(r).data("key"),l=$(r).data("mybase"),i="";switch(o){case"title":case"body":case"type":$(r).append(a[n][o]);break;case"url":case"documentname":case"complimentary":case"complimentaryname":var c,d=t.sortedData[n][o],s=$(r).attr("href");"internal"==l?i=myBaseInternal:"none"!=l&&(i=myBase),c=s?i+s+d:d&&0==d.indexOf("http")?d:i+d,$(r).is("option")?$(r).attr("value",c):$(r).attr("href",c),$(r).attr("target")||$(r).attr("target",t.sortedData[n].target);break;case"thumbnail":case"image":case"thumbnailname":case"imagename":var p=test_for_mobile_toggle(r,o),g=a[n][p];if("internal"==l?i=myBaseInternal:"none"!=l&&(i=myBase),i.indexOf("../")>-1)var m=i.split("../")[0];else m=i;var _=m+g;"object"==typeof lazySizes?($(r).attr("data-src",_),$(r).addClass("lazyload")):$(r).attr("src",_),$(r).attr("alt",a[n].title);break;case"date":case"startdate":case"rangestartdate":case"asofdate":var u;u=null!=a[n].rangestartdate?a[n].rangestartdate:a[n].startdate,$(r).append(dateFormatter_v2(u,t.htmlData.dateformat))}}),"undefined"!=typeof docAppendDataComplete&&$.isFunction(docAppendDataComplete)&&docAppendDataComplete(t)}function test_for_mobile_toggle(t,e){return $(t).is('[data-mobiletoggle="true"]')?window.innerWidth<778?"thumbnailname":"imagename":e}$(document).ready(function(){swapTempLocationTickers(),collect_document_elements()});